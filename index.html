<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Global Counter</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css"
    />
    <link
      rel="stylesheet"
      href="https://github.hubspot.com/odometer/themes/odometer-theme-minimal.css"
    />
    <link
      rel="icon"
      href="https://api.communitrics.com/youtube/profile?channel=communitrics"
      type="image/png"
    />
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');

      :root {
        --bg-color: #000000;
        --surface-color: #111111;
        --button-color: #1a1a1a;
        --text-color: #ffffff;
        --border-color: rgba(255, 255, 255, 0.1);
      }

      body {
        font-family: 'Inter', sans-serif;
        background-color: var(--bg-color);
        min-height: 100vh;
        color: var(--text-color);
      }

      .odometer {
        font-family: 'Inter', sans-serif;
        font-weight: 700;
        line-height: 1;
        color: var(--text-color);
      }

      .btn {
        background-color: var(--button-color);
        border: 1px solid var(--border-color);
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .btn:hover {
        transform: translateY(-1px);
        background-color: #222222;
        border-color: rgba(255, 255, 255, 0.2);
      }

      .btn:active {
        transform: translateY(1px);
      }

      .btn:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none;
      }

      .counter-container {
        background: var(--surface-color);
        border: 1px solid var(--border-color);
      }

      .error-message {
        animation: slideIn 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      @keyframes slideIn {
        from {
          transform: translateY(-10px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }

      .link {
        position: relative;
        text-decoration: none;
      }

      .link::after {
        content: '';
        position: absolute;
        width: 100%;
        height: 1px;
        bottom: -2px;
        left: 0;
        background-color: currentColor;
        transform: scaleX(0);
        transform-origin: right;
        transition: transform 0.3s ease;
      }

      .link:hover::after {
        transform: scaleX(1);
        transform-origin: left;
      }
    </style>
  </head>
  <body class="flex items-center justify-center p-4 min-h-screen">
    <div
      class="counter-container max-w-4xl w-full mx-auto rounded-2xl p-8 sm:p-12"
    >
      <div class="text-center">
        <div
          class="odometer text-6xl sm:text-7xl md:text-8xl xl:text-9xl mb-12 tracking-tight"
          id="count"
        ></div>

        <div class="grid grid-cols-2 sm:grid-cols-3 gap-3 sm:gap-4 mb-8">
          <button
            id="increment-1"
            class="btn text-sm sm:text-base font-medium py-4 px-6 rounded-xl"
          >
            +1
          </button>
          <button
            id="increment-100"
            class="btn text-sm sm:text-base font-medium py-4 px-6 rounded-xl"
          >
            +100
          </button>
          <button
            id="increment-1000"
            class="btn text-sm sm:text-base font-medium py-4 px-6 rounded-xl"
          >
            +1,000
          </button>
          <button
            id="increment-10000"
            class="btn text-sm sm:text-base font-medium py-4 px-6 rounded-xl"
          >
            +10,000
          </button>
          <button
            id="increment-50000"
            class="btn text-sm sm:text-base font-medium py-4 px-6 rounded-xl"
          >
            +50,000
          </button>
          <button
            id="increment-100000"
            class="btn text-sm sm:text-base font-medium py-4 px-6 rounded-xl"
          >
            +100,000
          </button>
        </div>

        <div class="grid grid-cols-2 gap-3 sm:gap-4 mb-8">
          <button
            id="increment-500000"
            class="btn text-sm sm:text-base font-medium py-4 px-6 rounded-xl"
          >
            +500,000
          </button>
          <button
            id="increment-1000000"
            class="btn text-sm sm:text-base font-medium py-4 px-6 rounded-xl"
          >
            +1,000,000
          </button>
        </div>

        <div
          id="error-message"
          class="hidden bg-red-900/20 border border-red-800/30 text-red-400 p-4 rounded-xl mb-6 text-sm"
        ></div>

        <div class="text-sm text-gray-500">
          An
          <a
            href="https://github.com/charlie-ashford/global-clicker"
            target="_blank"
            rel="noopener noreferrer"
            class="link text-gray-400 transition-colors"
            >open-source</a
          >
          global clicker
        </div>
      </div>
    </div>

    <script src="https://github.hubspot.com/odometer/odometer.js"></script>
    <script>
      (() => {
        const countElement = document.getElementById('count');
        const errorMessageElement = document.getElementById('error-message');
        const buttons = [
          { id: 'increment-1', amount: 1 },
          { id: 'increment-100', amount: 100 },
          { id: 'increment-1000', amount: 1000 },
          { id: 'increment-10000', amount: 10000 },
          { id: 'increment-50000', amount: 50000 },
          { id: 'increment-100000', amount: 100000 },
          { id: 'increment-500000', amount: 500000 },
          { id: 'increment-1000000', amount: 1000000 },
        ];

        let odometerInitialized = false;
        let currentCount = 0;

        function initializeOdometer(initialCount) {
          currentCount = initialCount;
          countElement.innerHTML = initialCount;
          odometerInitialized = true;
        }

        function updateCount(newCount) {
          currentCount = newCount;
          countElement.innerHTML = newCount;
        }

        function fetchCount() {
          fetch('https://api.communitrics.com/counter')
            .then(response => response.json())
            .then(data => {
              if (!odometerInitialized) {
                initializeOdometer(data.count);
              } else {
                currentCount = data.count;
              }
            })
            .catch(error => console.error('Error fetching count:', error));
        }

        function refreshOdometer() {
          countElement.innerHTML = currentCount;
        }

        function displayError(message) {
          errorMessageElement.textContent = message;
          errorMessageElement.classList.remove('hidden');
          setTimeout(() => {
            errorMessageElement.classList.add('hidden');
          }, 15000);
        }

        function incrementCount(amount, button) {
          button.disabled = true;
          fetch('https://api.communitrics.com/counter', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ action: 'increment', amount: amount }),
          })
            .then(response => response.json())
            .then(data => {
              if (data.error) {
                displayError(data.error);
              } else {
                currentCount = data.count;
              }
            })
            .catch(error => {
              console.error(`Error incrementing count by ${amount}:`, error);
              displayError('An error occurred. Please try again.');
            })
            .finally(() => {
              setTimeout(() => {
                button.disabled = false;
              }, 300);
            });
        }

        buttons.forEach(buttonInfo => {
          const button = document.getElementById(buttonInfo.id);
          button.addEventListener('click', () =>
            incrementCount(buttonInfo.amount, button)
          );
        });

        fetchCount();
        setInterval(fetchCount, 2000);
        setInterval(refreshOdometer, 2000);
      })();
    </script>
  </body>
</html>
